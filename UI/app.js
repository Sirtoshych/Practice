/**
 * Created by Sirtoshych on 3/28/2017.
 */
var express = require('express');

var app = express();
var bodyParser = require('body-parser');

app.use(express.static('public'));
app.use(bodyParser.json());

app.get('/', function(req,res){
    res.send('index.html');
});

app.get('/articles', function (req,res) {
    res.send(Articles)
});

app.get('/article/:id', function (req, res) {
    res.send(Articles.find(function (item) {
        return item.id === req.params.id;
    }))
});

app.put('/article/:id', function (req, res) {
    var index = Articles.findIndex(function (item) {
        return req.params.id === item.id;
    });
    if (index === -1) {
        res.sendStatus(400);
    }
    if (req.body.title) {
        Articles[index].title = req.body.title;
    }
    if (req.body.summary) {
        Articles[index].summary = req.body.summary;
    }
    if (req.body.image) {
        Articles[index].image = req.body.image;
    }
    if (req.body.content) {
        Articles[index].content = req.body.content;
    }
    if (req.body.tags) {
        Articles[index].tags = req.body.tags;
    }
    res.sendStatus(200);
});

app.delete('/article/:id', function (req, res) {
    var index = Articles.findIndex(function (item) {
        return item.id === req.params.id;
    });
    if (index === -1) {
        res.sendStatus(400);
    } else {
        Articles.splice(index, 1);
        res.sendStatus(200);
    }
});

app.listen(3000, function () {

    console.log('App listening on port 3000!');

});

app.post('/articles', function (req, res) {
    var article = {
        id: new Date(),
        title: req.body.title,
        summary: req.body.summary,
        createdAt: new Date(),
        author: req.body.author,
        image: req.body.image,
        tags: req.body.tags,
        content: req.body.content
    };
    Articles.push(article);
    res.sendStatus(200);
});



var Articles = [
    {  /* main news */
        id: '1',
        title: "??????? «??????» ???????? ??????????? «?????????»'",
        summary: '??????? «??????» ???????? ??????????? «?????????» ? ????????? ????? ??????? ?????? ????-??? ??? — 4:2',
        createdAt: new Date('2017-02-27T23:00:00'),
        author: '?????? ',
        content: '????? ??????? ?????? ??????? ???????? ? ? ??? ???? ??????????? ??????, ?? «?????» ?? ???? ??? ????? ?????????? ???????????? ???? ???????.',
        tags: ['Sport','Health','Society','Default'],
        image: 'images/1.jpg'
    },
    {/* sidenews column 1 row 1 */
        id: '2',
        title: '????-?????? ?????????? ?????????? ? ??????????: ????????? ????????? ? ?????? ? ????????',
        summary: '? ?????? ? ????????? ????????? ?????????: ??? ? ????????? ????? ?????? ?????????? ?????????? ????? ???????? ?????????. ?? ???? TUT.BY ????????? ???? ?? ',
        createdAt: new Date('2017-02-27T22:00:00'),
        author: '??????',
        content: '??? ??????????????? ?????? ?????????????? ? ????????? ? ??????????????? TUT.BY ???????, ??? ?????? ?? ????????? ???????? ??????. ? ????????? ????? ???????????? ?? ??????? ???????? ?????.',
        tags: ['Society','Politics','Default'],
        image: 'images/1.jpg'
    },
    {   /* sidenews column 2 row 1 */
        id: '3',
        title: 'LOL KEK',
        summary: '?? ??????????? ???????-???????? ????? 6 ????? ?????? ????????? ????? ????????. ???? ????? ???????? ? ???? ? ??????????? ?????.',
        createdAt: new Date('2017-02-27T21:00:00'),
        author: '????',
        content: '?????? ???????? ?? BYN0,011 — ?? 1,9031 ?????.???? ????? ?? BYN0,0072 — ?? 2,0203 ?????.?????????? ????? ????????? ?? BYN0,0146 — ?? 3,2651 ?? 100 ?????????? ??????.',
        tags:['Politics','Finance','Default'],
        image: 'images/1.jpg'

    },
    {   /* sidenews column 1 row 2 */
        id: '4',
        title: '??????? ??????? «???????» ?????. ',
        summary: '??????????, ??? ?????? ???????????? ?????????? ? ???????? ? ?? ??????????????? ?????? ???????? ? ???? ??????. ',
        createdAt: new Date('2017-02-27T21:00:00'),
        author: '??????',
        content: '????? ????????? ?? ???????? 70 ????????? €.',
        tags: ['Sport', 'Popular','Default'],
        image: 'images/1.jpg'
    },
    {   /* sidenews column 2 row 2 */
        id: '5',
        title: '?????? ????? ???? ????? ?????????? ??????????? ? ???????',
        summary: '?????????? ???????? ?????, ??????????? ?? ???? ??????? ?? ???? ????????? ?????????? ??????, ????? ? ????????? ??????? ? ???????? 50 ??? ? 7 ????.',
        createdAt: new Date('2017-02-27T20:00:00'),
        author: '??',
        content: '????? ??????? ????? ????? ?????????? ??????????? ?????????? ?????? ???????, ??????? ? 1965 ???? ? ???????? 50 ??? ? 5 ???? ?????? ??????????? ???? ? ??????? "???? ????".',
        tags: ['Sport', 'Health','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '6',
        title: '? ????? ??????? ????????? ??????? ?????????? ????, ??????? ??? ?????????? ????????.',
        summary: '4 ????? ?????????? ??????? ? ???????? ????????? ??????? ?????????? ????, ??????? ??? «??????????????????? ???????????????? ????????».',
        createdAt: new Date('2017-02-27T19:00:00'),
        author: '??',
        content: '«??????? ? ???? ????????????? ????????? ???? ????? ????????? ?????????, ??????? ???????? ???????? ????? ? ??????????, ???????? ??? ???, ??? ?? ???????? ??????????????????? ???????????????? ??????',
        tags: ['Sport','Politics','Default'],
        image: 'images/1.jpg'
    },
    {
        id: '7',
        title: '??????? ???? ??????????? ?????????, ??? ??? ???????? ? ?????? ????? ?????? ? ????????',
        summary: '???????? ?? ?????????? ? ???????????? ?????? ???????? ????????? ???????? ???????? ????? ?????????.',
        createdAt: new Date('2017-02-27T18:00:00'),
        author: '??',
        content: '?? ??? ??????, ???????? ?????? ?????????? ? ?????. ?????????? ??????? ???? ?????????? ??????????? ???????? ?? ?? 10 ?????, ',
        tags: ['Politics', 'Society','Default'],
        image: 'images/1.jpg'
    },
    {
        id: '8',
        title: '? ?????? ???? ???? ??? ??????????? "????? ???????????"',
        summary: '??? ?????????? ?????? ?????? 6 ????? ????????????? ???????????????? ???? ? ????????? ?????????????? ????????????? ????????,',
        createdAt: new Date('2017-02-27T17:00:00'),
        author: '??',
        content: '6 ????? ? ?????? ??????? ??? ??? ???????????? ???????????. ???????? ??????? ??? ???? ?????????? ? ??? ?????????? ????, ??? ??????? ????.',
        tags: ['Politics','Society','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '9',
        title: '???? ?????????? ????????????? ?????? ????? ??? ??????????? ???????, ???????? ? ??????? ?????',
        summary: '???????????? ???????????????? ????????????? ? ???????? ??????????? ?????? ????? ??????????, ?????????????? ????????? ?? ???????? ?? ????? 2020 ????',
        createdAt: new Date('2017-02-27T16:00:00'),
        author: '??',
        content: '?????? ??????????????? ???????? ?? 31 ??????? 2020 ???? ????????? ?? ?????????? ???????? ???????? ?????????? ????????? ??????????????, ?? ??????????? ???????? ??????????? ? ????????? ???????, ???????? ?? ??????????? ???????????? ?????????? ? ?????????????? ????????.',
        tags: ['Health', 'Society','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '10',
        title: '???????????? ???????? ???????? ? ?????? ??????????? ? ????????????, ????????? — ? 12 ?????',
        summary: '??????? ????????? ??? ?????????? ???????????? ????????? ???????? ??????? ???? ? ??????? 2015 ?. ? ??????, ? ????? ???????? ??????? ? ????????? ? ???????????? ?????????? ? ???????????? ?????????.',
        createdAt: new Date('2017-02-27T15:00:00'),
        author: '????',
        content: '????????, ?? ?????? ?????????, ???????? ???????? ? ?????? ????? ????????: 27-?????? ??????????????? ??????? ????? ?????????? ?????? ??????? ??????? ?????. ??? ????????? ?????? ?? ???? ?????????? ?????????? (????? ????????) ? ??? ???????? ????????? ??????? «?????????» ????????? ? ???????? ?? ???? ?????? — ??????.',
        tags: ['Society','Health','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '11',
        title: '????? ???????? ????? ?????????????? ???? ',
        summary: '????????? ??? ??????? ????? ???????? ????? ???? ?? ??????????? ???????????? ????????, ???????? ????????????? ?????? ????. ?? ???????? ? ???? ? 16 ?????.',
        createdAt: new Date('2017-02-27T14:00:00'),
        author: '??',
        content: '?? ?? ??????, ????? ??????????? ???????? ???? ??????? ??? ?????????? «???? ?????», ???? ????????? ?????? ? ???????? ??? ?????? ??????',
        tags: ['Politics', 'Society','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '12',
        title: '???????? ?? ????? ??????? ????????? ? ???????? ????? ????????? ??????',
        summary: '???????? ?? ????? ??????? ????????? ? ???????? ????? ????????? ??????,. ?? ???? ?? ?????-??????????? ?????? ??????? ?????????? ? ???????????? ???????? ???????? ?????.',
        createdAt: new Date('2017-02-27T13:00:00'),
        author: '??',
        content: '??????? ??????, ????????? ??? ?????????, ??????????? ?????? ? ????????????? ? ???, ????? ??????? ?????? ??????? ??????? ? ?? ????? ?????????? ??? ????? ???????????????. ???????? ?? ??, ??? ??????????? ?? ???? ???????? ?????????? ? ??????, ??????? ?? ??? ?? ????????????? ? ????? ???????????.',
        tags:['Society', 'Health','Default'],
        image: 'images/1.jpg'
    },
    {
        id: '13',
        title: '???????, ??? ? ?????. ???-10 ??????? ?????? ? Instagram ?? ??????',
        summary: 'TUT.BY ?????????? ???????? ????? ?????????? ?? ????? ???? ? Instagram,',
        createdAt: new Date('2017-02-27T12:00:00'),
        author: '????',
        content: 'TUT.BY ?????????? ???????? ????? ?????????? ?? ????? ???? ? Instagram, ??????? ??????? ? ?????? ?? ???? ????. ? ??????????? ???????? — ?????, ?????, ??????? ?? ??????????? ??????? ? ??? ? ?????? ???????.',
        tags:['Society','Popular','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '14',
        title: '??????? ????????? ????? ? ?????? ????? ????????????? ? ?????? "???? ????????? ???????" ',
        summary: '???????? ? ?????????? ????????????? ???????? ????????????-???????????????? ????????? ? ?????????? ??????? ?? ????? ?. ???????? ? ??????. ',
        createdAt: new Date('2017-02-27T11:00:00'),
        author: '??????',
        content: '??? ?????????? ??????????? ????? ? ???????? ????? ?????? ?????? «???? ????????? ???????». ????? ?? ???? ????? ???? ???? ?? ??? ???????????? ????? ??????. ?????? ?????????? ??? ????? ????????????? ????????????.',
        tags:['Sport', 'Society','Health','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '15',
        title: '????? ?? ??????? "?????????". ???????? ?????? ?? 20%',
        summary: '????????????! ????? ???????? ? ???? ????? ? ??????? ?????????? ?????: ??????? ?? ?????, ?????????, ?????????? ? ????????...',
        createdAt: new Date('2017-02-27T10:00:00'),
        author: '??????????',
        content: '??????? ???????? ?????? ?? ???, ???-?? ???????? ? ????… ??? ?? ?????...'     ,
        tags: ['Health','Society','Default'],
        image: 'images/1.jpg'
    },
    {
        id: '16',
        title: '? ???????? ????????????? 13 ???????? ?? ?????? ???? ',
        summary: '?????? ???????????? ????????????? 13 ????????????? ???????? ? ???????? ? ???? 2013 ????',
        createdAt: new Date('2017-02-27T09:00:00'),
        author: '????????',
        content: '?? ????????? ?? ???? ??????, ??????????? ?????????????? ???????? Action Counters Terrorism «???????? ?????? ??????????», ??????? ????????? ?????????????? ???????? ? ??????? ? ????? ???????????.',
        tags: ['Politics', 'Health', 'Society','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '17',
        title: '??? ???????? ??????????. 10 ???????, ??????? ?? ??????',
        summary: '?? ???? ????????, ?????????? ? ????????????? ??? ?????? ???????, ??????? ??????? ????????? ?????? ???-?????????',
        createdAt: new Date('2017-02-27T08:00:00'),
        author: '????',
        content: '? ???, ??? ???????? ????????? ? ????????? ??????????, «????????????? ???????????? ?????????» ?????? ??? ?????????? ?????????, ? ??????? ??????????????? ?????? ????? ?????, ?? ??????? ?????? ??? ???????????? ?? ??????????? ?????? ??????????????? ?????????.',
        tags: ['Politics','Health', 'Society','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '18',
        title: '? ????????????? ?????? BMW ??????????? ? ????? ? ??????',
        summary: '?????? ????????? 6 ?????, ????? 07.40, ? ????????????? ??????. ?? ???? ???????? ? ??? ??? ?????????? ????????????.',
        createdAt: new Date('2017-02-27T07:00:00'),
        author: '?',
        content: '— ?? ??????????????? ??????????, 23-?????? ???????? BMW 320 ???? ?? ???????? ?? ?/? ?108 ? ??????? ????????. ?? ??????????? ?????? ????? ?? ?? ????????? ? ???????????, ?????????? ?????? ? ????? ?????, ??????????? ? ?????????, — ??????? ? ???.',
        tags: ['Society', 'Health','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '19',
        title: '????????? ?????????? ????????? ?? ????????????????????? ??????????',
        summary: '????????? ?????????? «??????? ????????» ??????? ??????? ????????? ?? ????????????????????? ??????????, ????',
        createdAt: new Date('2017-02-27T06:0:00'),
        author: '?',
        content: '?? ?????? ????????, ?? ????????? ? ??????? ?? ??????? ????????? ?????? ??-?? ????, ??? ?? ?????? ????? ???????? ? ?????? ?????????? ????????? ????? ?????????????. ??????? ??? ??????? ????????????? ????????.',
        tags: ['Society', 'Politics','Default'],
        image: 'images/1.jpg'

    },
    {
        id: '20',
        title: '"??? ????? ?? ?????? ??????". ????????? ?????????? ? ??????????? ?? ????????? ? ??????? ????????? ',
        summary: '???????? ???????? ?????????? ????????? ???????????? ? ????? ?????, «????? ????? ????? ???».',
        createdAt: new Date('2017-02-27T05:00:00'),
        author: '??',
        content: '«? ???? ? ?????, ??? ?? ? ????????? ???????? ?????????? ?????? ???? ??????? ?? ???? ???????????», — ?????? ????? ???????????.',
        tags: ['Politics', 'Society','Default'],
        image: 'images/1.jpg'

    }
];
